<script type="text/javascript" src=" ../stylesheets/jquery-1.7.2.js"></script>
<script type="text/javascript" src=" ../stylesheets/jquery.validate.js"></script>
<link type="text/css" rel="stylesheet" href="http://craigsworks.com/projects/qtip2/packages/nightly/jquery.qtip.css" />
<script type="text/javascript" src="http://craigsworks.com/projects/qtip2/packages/nightly/jquery.qtip.js"></script>

<script>
$(document).ready(function() {
	
    var tab_pool = ["tab_Chemical", "tab_Application", "tab_Location", "tab_Floods", "tab_Crop", "tab_Physical", "tab_Output"];
    var visible = $(".tab:visible").attr('class').split(" ")[1];
    var curr_ind = $.inArray(visible, tab_pool);
    $(".submit").hide();
    $(".back").hide();

//Input form validation method

	function isSci(txtValue) {
		var currVal = txtValue;
		if (currVal == '')
		   return false;
	  //Declare Regex  
	  var rxNumberPattern = /^-?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/;
	  var dtArray = currVal.match(rxNumberPattern); // is format OK?
	  if (dtArray == null)
		  return false;
	  return true;
	}	
	
	function isDate(txtDate) {
		var currVal = txtDate;
		if (currVal == '')
		   return false;
	  //Declare Regex  
	  var rxDatePattern = /^(\d{1,2})(\/|-)(\d{1,2})$/;
	  var dtArray = currVal.match(rxDatePattern); // is format OK?
	  if (dtArray == null)
		  return false;
	   //Checks for dd/mm format.
	   var dtDay = dtArray[3];
	   var dtMonth = dtArray[1];
		
        if (dtMonth.length != 2 || dtMonth < 1 || dtMonth > 12) 
			return false;
        else if (dtDay.length != 2 || dtDay < 1 || dtDay > 31) 
			return false;
        else if (dtMonth == 2 && dtDay > 29) 
			return false;
        else if ( (dtMonth == 4 || dtMonth == 6 || dtMonth == 9 || dtMonth == 11) && (dtDay > 30)) 
			return false;
        return true;
	}	

    function mmCheck(value) {
        var mmValue = value;
        if (mmValue < 1 || mmValue > 12) 
			return false;
        return true;
    }

    function ddCheck(value, element) {
        var mmValue1 = $(element).parent().prev('td').children('input').val();
		//console.log(mmValue1);
        var ddValue1 = value;
		//console.log(value);
        if (ddValue1 < 1 || ddValue1 > 31) 
			return false;
        else if (mmValue1 == 2 && ddValue1 > 29) 
			return false;
        else if ((mmValue1 == 4 || mmValue1 == 6 || mmValue1 == 9 || mmValue1== 11) && (ddValue1 > 30) )
			return false;
        return true;
    }

    function wlflCheck(value, element) {
        var flValue1 = $(element).parent().prev('td').children('input').val();
		//console.log(flValue1);
        var wlValue1 = value;
		//console.log(wlValue1);
        if (flValue1 >wlValue1) 
			return false;
        return true;
    }

    function mlflCheck(value, element) {
        var flValue1 = $(element).parent().prev('td').prev('td').children('input').val();
		//console.log(flValue1);
        var mlValue1 = value;
		//console.log(mlValue1);
        if (mlValue1 >flValue1) 
			return false;
        return true;
    }
			
	$.validator.addMethod(
		"sciFormat",
		function (value, element) {
			return isSci(value)
		},
		"Please use the right numeric format"
	);
	
	$.validator.addMethod(
		"dateFormat",
		function (value, element) {
			return isDate(value)
		},
		"Please enter a date in the format MM/DD"
	);

    $.validator.addMethod(
        "monthCheck",
    function (value) {
        return mmCheck(value);
    },
        "Please enter a right month");

    $.validator.addMethod(
        "dayCheck",
    function (value, element) {
        return ddCheck(value, element);
    },
        "Please enter a right day");

	$.validator.addMethod("integer", function(value, element) {
		return this.optional(element) || /^-?\d+$/.test(value);
	}, "A positive or negative non-decimal number please");

    $.validator.addMethod(
        "wlflCheck",
    function (value, element) {
        return wlflCheck(value, element);
    },
        "Wier Level should be greater than Fill Level");

    $.validator.addMethod(
        "mlflCheck",
    function (value, element) {
        return mlflCheck(value, element);
    },
        "Min. Level should be less or equal than Fill Level");
										
    var validator = $('form').validate({
        ignore: 'input[type="button"],input[type="submit"]',
        rules: {
			//Chemical tab//
            wat_hl: {
                required: true,
				sciFormat: true
            },
            wat_t: {
                required : true,
				sciFormat: true
            },
            ben_hl: {
                required : true,
				sciFormat: true
            },			
            ben_t: {
                required : true,
				sciFormat: true
            },			
            unf_hl: {
                required : true,
				sciFormat: true
            },			
            unf_t: {
                required : true,
				sciFormat: true
            },			
            aqu_hl: {
                required : true,
				sciFormat: true
            },			
            aqu_t: {
                required : true,
				sciFormat: true
            },			
            hyd_hl: {
                required : true,
				sciFormat: true
            },			
            mw: {
                required : true,
				sciFormat: true
            },
            vp: {
                required : true,
				sciFormat: true
            },				
            sol: {
                required : true,
				sciFormat: true
            },				
            koc: {
                required : true,
				sciFormat: true
            },				
            hea_h: {
                required : true,
				sciFormat: true
            },				
            hea_r_t: {
                required : true,
				sciFormat: true
            },
			///Application////			
            noa: {
                required : true
            },			
			///Location//////
            weather: {
                required : true,
            },			
            wea_l: {
                required : true,
            },
			///Floods//////
            nof: {
                required : true,
            },								
			date_f1: {
                required : true,
				dateFormat:true
            },
			///Floods//////
			zero_height_ref: {
                required : true,
				dateFormat:true
            },			
			days_zero_full: {
                required : true,
				sciFormat:true
            },				
			days_zero_removal: {
                required : true,
				sciFormat:true
            },	
			max_frac_cov: {
                required : true,
				sciFormat:true
            },
			///Physical////
			mas_tras_cof: {
                required : true,
				sciFormat:true
            },       
			leak: {
                required : true,
				sciFormat:true
            },       			
			ref_d: {
                required : true,
				sciFormat:true
            },   			
			ben_d: {
                required : true,
				sciFormat:true
            }, 			
			ben_por: {
                required : true,
				sciFormat:true
            }, 				
			dry_bkd: {
                required : true,
				sciFormat:true
            }, 		
			foc_wat: {
                required : true,
				sciFormat:true
            }, 			
			foc_ben: {
                required : true,
				sciFormat:true
            }, 				
			ss: {
                required : true,
				sciFormat:true
            }, 				
			wat_c_doc: {
                required : true,
				sciFormat:true
            }, 			
			chl: {
                required : true,
				sciFormat:true
            }, 				
			dfac: {
                required : true,
				sciFormat:true
            }, 				
			q10: {
                required : true,
				sciFormat:true
            }		
			
			
					
		}
    });
	
	
    $('.next').click(function () {
        var tab = $(".tab:visible");
        var valid = true;
        $('input,select', tab).each(function(i, v){
            valid = validator.element(v) && valid;
        });
        if(!valid){
            return;
        }
		
        if (curr_ind < 6) {
			if (curr_ind == 1) {
            $(".tab:visible").hide();
            curr_ind = curr_ind + 1;
            $("." + tab_pool[curr_ind]).show();
            $(".tab_noa1").show();
            $(".submit").hide();
            $(".back").show();		
				}
				
			else{	
            $(".tab:visible").hide();
            curr_ind = curr_ind + 1;
            $("." + tab_pool[curr_ind]).show();
            $(".submit").hide();
            $(".back").show();
			}
        }
        if (curr_ind == 6) {
            $(".submit").show();
            $(".next").hide();
        }
    });

    $('.back').click(function () {
        if (curr_ind > 0) {
			
			if (curr_ind == 1) {
            $(".tab:visible").hide();
            curr_ind = curr_ind - 1;
            $("." + tab_pool[curr_ind]).show();
            $(".tab_noa1").show();
            $(".submit").hide();
            $(".next").show();		
				}
				
			else{
            $(".tab:visible").hide();
            curr_ind = curr_ind - 1;
            $("." + tab_pool[curr_ind]).show();
            $(".submit").hide();
            $(".next").show();
			}
        }
        if (curr_ind == 0) {
            $(".back").hide();
        }
    });
						
    var i = 1
	$('.tab_Application').append('<tr id="noa_header" style="display:none"><th width="18%">App#</th><th width="18%">Month</th><th width="18%">Day</th><th width="23%">Mass Applied</th><th width="23%">Slow Release</th></tr><tr id="noa_header" style="display:none"><th width="18%"></th><th width="18%"></th><th width="18%"></th><th width="23%">(kg/hA)</th><th width="23%">(1/day)</th></tr>');
		    
    $('#id_noa').change(function () {
        var total = $(this).val()
		$('tr[id*="noa_header"]').show()
		
        while (i <= total) {
            $('.tab_Application').append('<tr class="tab_noa1"><td><input name="jm' + i + '" type="text" size="5" value="' + i + '"/></td><td><input type="text" size="5" name="mm' + i + '" id="id_mm' + i + '"/></td><td><input type="text" size="5" name="dd' + i + '" id="id_dd' + i + '"/></td><td><input type="text" size="5" name="ma' + i + '" id="id_ma' + i + '"/></td><td><input type="text" size="5" name="sr' + i + '" id="id_sr' + i + '" value="0"/></td></tr>');
            i = i + 1;
        }
        while (i-1 > total) {
            $(".tab_Application tr:last").remove();
            i=i-1
        }
        $('</table>').appendTo('.tab_Application');
	//addtion rules for dynamic generated cells

    $('[name*="mm"]').each(function () {
        $(this).rules('add', {
            required: true,
            monthCheck: true,
			integer:true
        });
    });

    $('[name*="dd"]').each(function () {
        $(this).rules('add', {
            required: true,
            dayCheck: true,
			integer:true			
        });
    });
	

    $('[name*="ma"]').each(function () {
        $(this).rules('add', {
            required : true,
			sciFormat: true
        });
    });

    $('[name*="sr"]').each(function () {
        $(this).rules('add', {
            required : true,
            sciFormat: true
		});

	});
		
    })
	
	
    var j = 1
	$('.tab_Floods').append('<tr id="nof_header" style="display:none"><th width="10%">Event</th><th width="18%">Number of</th><th width="18%">Fill Level</th><th width="18%">Wier Level</th><th width="18%">Min. Level</th><th width="18%">Turn Over</th></tr><tr id="nof_header" style="display:none"><th width="10%"></th><th width="18%">Days</th><th width="18%">(m)</th><th width="18%">(m)</th><th width="18%">(m)</th><th width="18%">(1/day)</th></tr>');
			
    $('#id_nof').change(function () {
        var total_nof = $(this).val()
		$('tr[id*="nof_header"]').show()
		
        while (j <= total_nof) {
			if (j == 1){
            $('.tab_Floods').append('<tr class="tab_nof1"><td><input type="text" size="5" value="'+j+'" disabled/></td><td><input type="text" size="5" name="nod'+j+'" id="id_nod'+j+'" value="0" disabled/></td><td><input type="text" size="5" name="fl'+j+'" id="id_fl'+j+'"/></td><td><input type="text" size="5" name="wl'+j+'" id="id_wl'+j+'"/></td><td><input type="text" size="5" name="ml'+j+'" id="id_ml'+j+'"/></td><td><input type="text" size="5" name="to'+j+'" id="id_to'+j+'"/></td></tr>');			
			}
			else {
            $('.tab_Floods').append('<tr class="tab_nof1"><td><input type="text" size="5" value="'+j+'" disabled/></td><td><input type="text" size="5" name="nod'+j+'" id="id_nod'+j+'"/></td><td><input type="text" size="5" name="fl'+j+'" id="id_fl'+j+'"/></td><td><input type="text" size="5" name="wl'+j+'" id="id_wl'+j+'"/></td><td><input type="text" size="5" name="ml'+j+'" id="id_ml'+j+'"/></td><td><input type="text" size="5" name="to'+j+'" id="id_to'+j+'"/></td></tr>');
			}
            j = j + 1;
        }
        while (j-1 > total_nof) {
            $(".tab_Floods tr:last").remove();
            j=j-1
        }
        $('</table>').appendTo('.tab_Floods');
		
		$('[name*="nod"]').each(function () {
        $(this).rules('add', {
            required : true,
			integer: true
        });
    });

		$('[name*="fl"]').each(function () {
        $(this).rules('add', {
            required : true,
			sciFormat: true
        });
    });

		$('[name*="wl"]').each(function () {
        $(this).rules('add', {
            required : true,
			sciFormat: true,
			wlflCheck: true			
        });
    });

		$('[name*="ml"]').each(function () {
        $(this).rules('add', {
            required : true,
			sciFormat: true,
			mlflCheck: true			
        });
    });

		$('[name*="to"]').each(function () {
        $(this).rules('add', {
            required : true,
			sciFormat: true
        });
    });
					
    })



});


</script>
<style>
table.tab_noa td {
	width: 13px;
}
table.tab_noa th {
	width: 13px;
}
table.tab_nof td {
	width: 13px;
}
table.tab_nof th {
	width: 13px;
}
</style>
